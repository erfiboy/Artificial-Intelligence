\documentclass[a4paper,12pt]{article}
\usepackage{heading}
\usepackage{listings}
\usepackage[shortlabels]{enumitem}
\usepackage{hyperref}
\usepackage{float}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{amssymb}	
\usepackage{tcolorbox}
\usepackage{xepersian}
\usepackage{changepage}

\settextfont{XB Niloofar.ttf}
\usetikzlibrary{arrows}

\doublespacing


\begin{document}

\handout

{شبکه عصبی پرسپترون چندلایه}
{عرفان نصرتی}
{استاد آرش عبدی‌هجران‌دوست}
{}
{پروژه دوم}

\section*{}
\section*{مقدمه}
در این پروژه قصد داریم که با استفاده از کتابخانه آماده sklearn به پیاده سازی شبکه عضبی پرسپترون چند لایه بپردازیم. 
\section{سوال یک}
در سوال اول از ما خواسته شده است که توابعی با ورودی یک بعدی از ساده و سخت ایجاد کنیم و شبکه عصبی خود را روی هر یک از این تابع ها تست کنیم و تاثیر هر یک از عوامل ورودی را بر خروجی تابع مشاهده کنیم. در ابتدا سه تابع استفاده شده در این شبیه سازی من عبارت‌اند از $  y = x+4 $ که این تابع به عنوان تابع ساده استفاده شده است و یک تابع خطی از ورودی به خروجی است. تابع متوسط ، 
$  y = sin(\frac{x\pi}{5}) $
است که یک سینوسی با ساده است. و اما در آخر تابع سخت من برابر است با، $  y= sin(2\pi x) + sin(5\pi x) $ که این تابع برابر است با مجموع دو تابع سینوسی با فرکانس متفاوت.
\newline
حال در زیر به جزئیات پیاده‌سازی و خواسته های‌ مسئله از قبیل تاثیر هر کدام از پارامتر ها بر جواب مسئله می‌پردازیم.
\subsection{تابع آسان}

 \begin{figure}[H]
\includegraphics[width=0.8\textwidth]{../q1/code}
\centering
\end{figure}
همانطور که در بالا قابل مشاهده است، در ابتدا در خطوط ۱۵ و ۱۶ ما ورودی های شبکه عصبی خود را ایجاد می‌کنیم این ورودی ها به صورت پارامتریک هستند تا بعدا با تعویض آنها اثر آنها را بر شبکه عصبی پیدا کرد.
در ادامه این کار را برای نقاط تست هم انجام می‌دهیم تا مقدار واقعی نقاطی را که قرار است به وسیله شبکه عصبی تخمین بزنیم داشته باشیم. و سپس یک شبکه عصبی با تعداد تکرار محاسبات و تعداد لایه ها ایجاد می‌کنیم لازم به توضیح است از اینجای پروژه به بعد (10,10,30) این عبارت به این معنی است که لایه پنهان شبکه عصبی دارای ۳لایه است و تعداد نورون های این لایه ها به ترتیب برابر هستند با 10 و 10 و 30 یعنی جمعا  50 نورون داریم. حال در زیر تصاویر مختلف و تاثیرات پارامتر هارا می‌اوریم و آنها را بررسی می‌کنیم.
\newpage
\section{سوال چهارم}
در این سوال از ما خواسته شده بود که یک شکل در کاغذ بکشیم و مقدار بالا یا پایین آن را به عنوان یک تابع در نظر بگیریم در زیر شکل کشیده شده آورده شده است و سپس مقدار تخمین زده آن نیز در قسمت بعدی آورده شده است. اگر در خط خطی ها خیلی تغییرات ناگهانی داشته باشیم انگار که یک تابع سخت تر برای یادگیری برای شبکه داریم به همین علت خشونت خود را فرونشاندم و این حربه استاد رو دفع کردم :) . (وَالْكَاظِمِينَ الْغَيْظَ وَالْعَافِينَ عَنِ النَّاسِ)
\begin{figure}[H]
\begin{center}

  \includegraphics[width=\linewidth]{../q4/sign}
  \center
  \caption{ مقدار کشیده شده در paint}
\end{center}
\end{figure}
در زیر ابندا مدل هایی که به اشتباه ترین شده اند آمده است و در آخر مدلی که به درستی آموزش داده شده بود آمده است.

\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[10, 9]}
  \caption{  اولین تلاش با شبکه (10,9) }
\endminipage\hfill
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[10, 8]}
  \caption{دومین تلاش با شبکه (10,8) }
\endminipage\hfill
\end{figure}

\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[9, 9]}
  \caption{  سومین تلاش با شبکه (9,9) }
\endminipage\hfill
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[10, 10, 10]}
  \caption{چهارمین تلاش با شبکه (10,10,10 }
\endminipage\hfill
\end{figure}

\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[10, 10]}
  \caption{  پنجمین تلاش با شبکه (10,10) }
\endminipage\hfill
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[10, 11]}
  \caption{ششمین تلاش با شبکه (10,9 }
\endminipage\hfill
\end{figure}


\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[12, 12]}
  \caption{  هفتمین تلاش با شبکه (12,12) }
\endminipage\hfill
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[10, 20]}
  \caption{هشتمین تلاش با شبکه (10,20 }
\endminipage\hfill
\end{figure}


\begin{figure}[!htb]
\begin{center}
  \includegraphics[width=\linewidth]{../q4/linear_1-71000_[10, 10]}
  \center
  \caption{ بهترین مقدار تخمین شده شده}
\end{center}
\end{figure}

\newpage
\section{سوال پنجم}
در این قسمت به یادگیری پایگاه تصویر داده شده در صورت سوال پرداختیم. ابتدا در زیر به توضیح کد می‌پردازیم سپس نتایج و پارامتر های تست شده را شرح می‌دهیم و اثر هر یک را توضیح می‌دهیم. ابتدا باید تصاویر داده شده را در پروژه لود می‌کردیم و سپس آنها را استفاده می‌کردیم. برای لود کردن تصاویر از کتابخانه opnecv2 استفاده کردم و عکس را به صورت Grayscale لود کردم. از آنجایی که عکس ها همه ۱۶ در ۱۶ بودند برای یادگیری توسط شبکه آنها را به وسیله کتابخانه numpy به یک آرایه ۲۵۶ در ۱ تبدیل کردم . چالش بعدی تعیین y یا خروجی درست و مورد انتظار ما از شبکه بود که این را از lable های تصاویر استخراج کردم به این صورت که نام عکس رو دو قسمت کردم و قسمت اول برابر با عددی بود که داخل عکس قرار داشت و مقدار خروجی متناظر آن عکس آن عدد می‌شد. سپس با استفاده از MLPRegressor یک شبکه با اندازه های مختلف در ایجاد کردم. و در آخر برای بدست آوردن نتایج از cross-validate استفاده کردم که با استفاده از $ fold = 10 $ بهترین شبکه و میانگین امتیاز شبکه ها را روی داده های آزمایشی بدست آوردم.

\subsection{تعداد چرخه هاي شبکه براي تکمیل یادگیری }

\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q5/1}
  \caption{ تعداد دفعات برابر 1000 }
\endminipage\hfill
\minipage{0.50\textwidth}
  \includegraphics[width=\linewidth]{../q5/2}
  \caption{ تعداد دفعات برابر 10000 }
\endminipage\hfill
\end{figure}

همانطور که از نتایج قابل مشاهده است تعداد چرخه ها در حالت اول ۱۰۰۰ و در حالت دوم ۱۰۰۰۰ است ولی نتایح همان است یعنی برای یادگیری شبکه همان مقدار 1000 کافی است و نیازی نیست بیشتر از آن چرخه را تکرار کرد.
\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q5/1}
  \caption{ تعداد دفعات برابر 1000 }
\endminipage\hfill
\minipage{0.50\textwidth}
  \includegraphics[width=\linewidth]{../q5/5}
  \caption{ تعداد دفعات برابر 500 }
\endminipage\hfill
\end{figure}
این آزمایش برای حالتی که درلایه اول به جای ۱۰۰ نورون ۱۰۰۰ نورون نیز داشتیم تکرار کردم و دوباره مشاهده شد که تغیری در بهتر شدن نتایج ایجاد نمی‌شود.

\newpage
\subsection{ عوض کردن تعداد نورون در لایه اول }

\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q5/2}
  \caption{ (100, 100) }
\endminipage\hfill
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q5/4}
  \caption{(1000, 100) }
\endminipage\hfill
\end{figure}

با افزایش ۱۰ برابر نورون های لایه اول از ۱۰۰ به ۱۰۰۰ دقت ما حدودا ۲ درصد افزایش داشته است که نشان دهنده این است که با توجه به اینکه شبکه همگرا شده است شبکه بزرگتری برای دسته بندی این اعداد نیاز است. حال این بزرگی را می‌توان با افزایش لایه و یا تعداد نورون ها در لایه‌ها ایجاد کرد.

\subsection{ شبکه با تعداد نورون ثابت و تعداد لایه های متفاوت }
در تمام شبکه های زیر 2000 نورون استفاده شده است در شبکه اول یک شبکه دولایه که هرکدام ۱۰۰۰ لایه هستند مورد بررسی قرار گرفته است در دومین شبکه مورد بررسی تعداد لایه ها به ۴ لایه افزایش یافت و طبعا با ثابت بودن تعداد نورون ها به 500 نورون در هر لایه رسیدیم. و در آخر نیز یک شبکه ۸ لایه با 250 نورون در هر کدام طراحی کردیم و نتایج را در زیر با یکدیگر مقایسه می‌کنیم.

\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q5/6}
  \caption{ شبکه ۴ لایه }
\endminipage\hfill
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q5/8}
  \caption{ شبکه ۸ لایه }
\endminipage\hfill
\end{figure}

\begin{figure}[!htb]
\minipage{0.48\textwidth}
  \includegraphics[width=\linewidth]{../q5/12}
  \caption{ شبکه دولایه }
\endminipage\hfill
\end{figure}

همانطور که در نتایج دیده می‌شوند حاصل نتایج برای شبکه با دولایه و ۴ لایه یکسان است و برابر 93.5 درصد است در صورتی که این عدد برای ۸ لایه 94.5 درصد است اما دقت در شبکه دولایه نسبت به شبکه ۴ لایه بهتر است با توجه به اینکه تمام پارامتر های دیگر ثابت بودند نتیجه می دهد که شبکه ۸ لایه دقت بهتری دارد با اینکه اندازه شبکه در همه حالات یکسان است.
\newpage
\section{سوال ششم}
در این قسمت نیز مانند قسمت قبل عکس ها را لود کردیم اما این بار به جای استفاده از لیبل در ورودی عکس نویز دار را قرار دادیم و در خروجی عکس اصلی بدون نویز را قرار دادیم و شبکه را همراه با cross-validate آموزش دادیم و بهترین شبکه آموزش دیده را برای از بین بردن نویز در تصاویر تست استفاده کردیم. برای ایجاد نویز از یک تابع استفاده کردیم که در زیر آمده است این تابع یک آرایه از عکس هارا در ورودی دریافت می‌کند و آرایه از عکس های‌نویزی را برمی‌گرداند. برای این کار از قسمت قبل به یاد داریم که عکس هارا در یک آرایه 255 تایی ذخیره کردیم و برای نویز دار کردن آن ابتدا 50 پیکسل را به تصاذف انتخاب می‌کنیم و توسط یک احتمال با متغیر threshold تعیین می‌شود احتمال اینکه پیکسل تغییر کند را تنظیم می‌کنیم سپس اگر پیکسلی بخواهد تغییر رنگ بدهد با توجه به اینکه روشنایی هر پیکسل عددی بین 0 تا 255 است اگر این عدد در بین ۰ تا ۱۲۸ باشد یعنی در بازه اول باشد آن را به بازه دوم یعنی ۱۲۸ تا ۲۵۵ می‌بریم و به صورت برعکس و با این کار عکس هارا نویز دار می‌کنیم.
\begin{figure}[!htb]
 \centering
  \includegraphics[width=10cm]{../q6/random}
  \caption{ شبکه دولایه }
\end{figure}
\newpage
حال به بررسی تابع های تست شده می‌پردازیم و نتایج هر کدام را در زیر می‌آوریم برای یک حالت با نویز کم مقدار تصاویر به صورت زیر بدست آمده است همچنین درصد دقت کلی برابر است با 81.6
\begin{figure}[!htb]
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image1_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image1_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image1_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image4_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image4_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image4_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image7_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image7_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image7_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image9_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image9_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image9_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image10_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image10_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image10_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image13_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image13_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image13_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image15_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image15_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image15_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image16_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image16_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image16_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image17_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image17_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image17_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image19_estimated}
  \caption{  عکس تخمین زده شده }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image19_noisy}
  \caption{  عکس نویزی }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/low_noiseaccuracy=0.8162596626778689/image19_original}
  \caption{  عکس اصلی }
\endminipage\hfill
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%
حال برای همین حالت نویز با عوض کردن شبکه داریم همچنین درصد دقت کلی برابر است 0.79 درصد است

\begin{figure}[!htb]
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image1_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image1_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image1_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image4_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image4_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image4_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image7_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image7_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image7_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image9_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image9_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image9_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image10_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image10_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image10_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image13_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image13_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image13_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image15_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image15_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image15_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image16_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image16_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image16_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image17_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image17_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image17_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image19_estimated}
  \caption{  عکس تخمین زده شده }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image19_noisy}
  \caption{  عکس نویزی }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise0.794240330660410925points/image19_original}
  \caption{  عکس اصلی }
\endminipage\hfill
\end{figure}


%%%%%%%%%%%%%%%%%
\newpage
حال تعداد پیکسل هایی که باید تغییر کنند را به دوبرابر حالت قبل یعنی ۵۰ پیکسل افزایش می‌دهیم همچنین درصد دقت کلی برابر است 0.75 درصد است

\begin{figure}[!htb]
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image1_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image1_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image1_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image4_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image4_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image4_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image7_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image7_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image7_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image9_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image9_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image9_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image10_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image10_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image10_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image13_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image13_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image13_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image15_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image15_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image15_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image16_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image16_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image16_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image17_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image17_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image17_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image19_estimated}
  \caption{  عکس تخمین زده شده }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image19_noisy}
  \caption{  عکس نویزی }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/meduim_noise accuracy=0.757187426886982350points/image19_original}
  \caption{  عکس اصلی }
\endminipage\hfill
\end{figure}


برای یک حالت سخت تر و نویز شدید تر داریم که دقت برابر 0.71 درصد است 

\begin{figure}[!htb]
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_501_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_501_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_501_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_504_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_504_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_504_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_507_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_507_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_507_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_509_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_509_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_509_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5010_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5010_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5010_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5013_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5013_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5013_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5015_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5015_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5015_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5016_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5016_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5016_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5017_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5017_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5017_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5019_estimated}
  \caption{  عکس تخمین زده شده }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5019_noisy}
  \caption{  عکس نویزی }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise_25_50/hard_noise_25_5019_original}
  \caption{  عکس اصلی }
\endminipage\hfill
\end{figure}



برای یک حالت سخت تر و نویز شدید تر داریم که دقت برابر 0.86 درصد است 

\begin{figure}[!htb]
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/1_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/1_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/1_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/4_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/4_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/4_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/7_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/7_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/7_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/9_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/9_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/9_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/10_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/10_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/10_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/13_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/13_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/13_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/15_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/15_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/15_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/16_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/16_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/16_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/17_estimated}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/17_noisy}
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/17_original}
\endminipage\hfill

\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/19_estimated}
  \caption{  عکس تخمین زده شده }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/19_noisy}
  \caption{  عکس نویزی }
\endminipage\hfill
\minipage{0.33\textwidth}
  \includegraphics[width=1cm]{../q6/hard_noise500_75_50_acc=0.8066889145997322/19_original}
  \caption{  عکس اصلی }
\endminipage\hfill
\end{figure}
\end{document}
